{
  "name": "N8N+Nanoè¡¨å•ä¿®å›¾å·¥ä½œæµ-ç”Ÿè§†é¢‘",
  "nodes": [
    {
      "parameters": {
        "formTitle": "AIå›¾åƒåˆ›ä½œåŠ©æ‰‹ - Gemini Nano",
        "formFields": {
          "values": [
            {
              "fieldLabel": "æç¤ºè¯",
              "fieldType": "textarea",
              "requiredField": true
            },
            {
              "fieldLabel": "å‚è€ƒå›¾",
              "fieldType": "file",
              "acceptFileTypes": ".jpg,.png,.jpeg"
            }
          ]
        },
        "responseMode": "lastNode",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -1792,
        -64
      ],
      "id": "aebb8559-21ba-49bd-bdc0-4f023c82b21c",
      "name": "On form submission",
      "webhookId": "f1020b25-bfc5-4b1a-a88a-b70c0d48a90d"
    },
    {
      "parameters": {
        "jsCode": "// CodeèŠ‚ç‚¹ - ç»„è£…payloadå¹¶åˆå§‹åŒ–é‡è¯•è®¡æ•°\nconst inputItems = $input.all();\nconst firstItem = $input.first();\nconst prompt = firstItem.json[\"æç¤ºè¯\"];\n\n// æ”¶é›†æ‰€æœ‰å›¾ç‰‡çš„ binary å±æ€§ååŠå…ƒæ•°æ®\nconst images = [];\nfor (let itemIndex = 0; itemIndex < inputItems.length; itemIndex++) {\n  const item = inputItems[itemIndex];\n  if (!item.binary) continue;\n\n  for (const [fieldName, binaryData] of Object.entries(item.binary)) {\n    if (binaryData?.mimeType?.startsWith('image/')) {\n      images.push({\n        itemIndex,\n        propertyName: fieldName,\n        mimeType: binaryData.mimeType,\n        fileName: binaryData.fileName || `${fieldName}`,\n      });\n    }\n  }\n}\n\n// æ„å»º content æ•°ç»„\nconst content = [];\nif (prompt && String(prompt).trim()) {\n  content.push({\n    type: \"text\",\n    text: String(prompt).trim(),\n  });\n}\n\n// å°†å›¾ç‰‡è½¬ä¸º data URLï¼ˆå…¼å®¹ filesystem / å†…å­˜ï¼‰\nasync function toDataUrl(itemIndex, propertyName, mime) {\n  // å®˜æ–¹æ¨èçš„æ–¹å¼ï¼šé€šè¿‡ helper è·å–çœŸå® Buffer\n  const buf = await this.helpers.getBinaryDataBuffer(itemIndex, propertyName); // docs: getBinaryDataBuffer\n  const b64 = buf.toString('base64');\n  return `data:${mime || 'application/octet-stream'};base64,${b64}`;\n}\n\n// å¤„ç†å›¾ç‰‡ï¼ˆè‹¥å­˜åœ¨ï¼‰\nfor (const img of images) {\n  const dataUrl = await toDataUrl.call(this, img.itemIndex, img.propertyName, img.mimeType);\n  content.push({\n    type: \"image_url\",\n    image_url: { url: dataUrl },\n  });\n}\n\n// è‹¥æ—¢æ— æ–‡æœ¬ä¹Ÿæ— å›¾ç‰‡ï¼Œåˆ™è¡¥ä¸€æ¡é»˜è®¤æ–‡æœ¬\nif (content.length === 0) {\n  content.push({\n    type: \"text\",\n    text: \"è¯·åˆ†æè¿™ä¸ªå†…å®¹\",\n  });\n}\n\n// æ„å»º payload\nconst payload = {\n  model: \"google/gemini-2.5-flash-image-preview\",\n  messages: [\n    {\n      role: \"user\",\n      content,\n    },\n  ],\n};\n\n// è¿”å› payload å’Œé‡è¯•è®¡æ•°\nreturn [\n  {\n    json: {\n      apiPayload: payload,\n      retryCount: 0,\n      maxRetries: 5,\n      originalFormData: firstItem.json,\n    },\n  },\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1584,
        -64
      ],
      "id": "fa062785-7d23-40e7-a1f5-74b3198d6b1a",
      "name": "Code"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openRouterApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.apiPayload }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1312,
        -64
      ],
      "id": "58d672eb-a0a0-40a8-9ac8-bbfd048c703a",
      "name": "HTTP Request",
      "credentials": {
        "openRouterApi": {
          "id": "PniCfeNtv6tmsVxZ",
          "name": "OpenRouter account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "merge-api-response",
              "name": "apiResponse",
              "value": "={{ $json }}",
              "type": "object"
            },
            {
              "id": "keep-max-retries",
              "name": "maxRetries",
              "value": "={{ $('Code').item.json.maxRetries }}",
              "type": "number"
            },
            {
              "id": "keep-api-payload",
              "name": "apiPayload",
              "value": "={{ $('Code').item.json.apiPayload }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1088,
        -112
      ],
      "id": "e39e5749-8f14-4d60-aacf-a9a498e3cb3a",
      "name": "Merge Response Data"
    },
    {
      "parameters": {
        "errorMessage": "ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"
      },
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        -1088,
        48
      ],
      "id": "faa750f7-1499-4180-9e4b-31f04c5a95ab",
      "name": "Network Error"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "content-filter-check",
              "leftValue": "={{ $json.apiResponse.choices[0].finish_reason === \"content_filter\" }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -896,
        -144
      ],
      "id": "00e0154d-bda1-42ed-a15b-5ceae81d74ab",
      "name": "Content Filter Check"
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "æŠ±æ­‰ï¼Œæ‚¨çš„å†…å®¹åŒ…å«ä¸å½“ä¿¡æ¯",
        "completionMessage": "è¯·é‡æ–°ä¸Šä¼ å‚è€ƒå›¾æˆ–è€…ä¿®æ”¹æç¤ºè¯åé‡è¯•",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 1,
      "position": [
        -688,
        -272
      ],
      "id": "bc6a117b-df91-44e7-b30a-40152696b707",
      "name": "Prohibited Content End",
      "webhookId": "96783571-d7d1-4005-a1dc-0cf26e5ca9e4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "image-exists-check",
              "leftValue": "={{ $json.apiResponse.choices[0].message.images }}",
              "rightValue": "",
              "operator": {
                "type": "array",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -688,
        -64
      ],
      "id": "2d1dc066-bafd-4dea-8fdc-4ff0b593b540",
      "name": "Image Check"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -496,
        64
      ],
      "id": "197111c6-bb9e-4836-b221-4c89c9ef2f9b",
      "name": "Wait",
      "webhookId": "df90a073-5c86-40ac-b15d-c8d3466b9f7c"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "extract-base64",
              "name": "base",
              "value": "={{ $json.apiResponse.choices[0].message.images[0].image_url.url.split(\",\")[1] }}",
              "type": "string"
            },
            {
              "id": "extract-mime",
              "name": "mime",
              "value": "={{ $json.apiResponse.choices[0].message.images[0].image_url.url.match(/^data:([^;]+)/)[1] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -480,
        -176
      ],
      "id": "4efe60af-57a6-4693-b70e-da0e9370877d",
      "name": "Extract Image Data"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -288,
        -176
      ],
      "id": "eb3efbf6-ca41-4a57-af74-bd219a40e4e6",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "operation": "completion",
        "respondWith": "returnBinary",
        "completionTitle": "ä½ çš„è§†é¢‘å·²ç”Ÿæˆ",
        "completionMessage": "=",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 1,
      "position": [
        1616,
        160
      ],
      "id": "99920ba5-7744-4f8a-9794-d74299e0a366",
      "name": "Success Form",
      "webhookId": "526420bc-73b1-42fc-aa7e-17175c0cffb9"
    },
    {
      "parameters": {
        "content": "#### é…ç½® OpenRouter å‡­è¯ ğŸ‘‡",
        "height": 80,
        "width": 214,
        "color": 3
      },
      "id": "dd89bb88-b868-41ae-aafa-ee2cc99734ec",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1376,
        -112
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## ğŸ¨ N8N+Nanoè¡¨å•å›¾ç”Ÿè§†é¢‘å·¥ä½œæµ\n\n\nğŸ“‹ åŸºæœ¬ä¿¡æ¯\nâ€¢ å·¥ä½œæµåç§°: Nano-Form-Image-to-Video-Workflow\nâ€¢ ç‰ˆæœ¬: v1.0.0\nâ€¢ æŠ€æœ¯æ ˆ: N8N + OpenRouter (Nano) + Form Trigger + Email + å³æ¢¦\nâ€¢ æ”¯æŒæ¨¡å¼: æ–‡ç”Ÿå›¾ + å›¾ç‰‡ä¿®å›¾ + å›¾ç”Ÿè§†é¢‘\nâ€¢ **åˆ›å»ºè€…**ï¼šæ—æœˆåŠå­\nâ€¢ **å¾®ä¿¡**ï¼šcloud-native-101\n\nğŸ¯ åŠŸèƒ½æ¦‚è¿°\nè¿™æ˜¯ä¸€ä¸ªåŸºäºè¡¨å•çš„AIå›¾åƒåŠè§†é¢‘åˆ›ä½œåŠ©æ‰‹ã€‚å®ƒæ”¯æŒçº¯æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡ã€ä¸Šä¼ å›¾ç‰‡è¿›è¡Œä¿®å¤æˆ–é£æ ¼è½¬æ¢ï¼Œå¹¶åœ¨äººå·¥å®¡æ ¸åï¼Œæ ¹æ®ç”Ÿæˆçš„å›¾ç‰‡è¿›ä¸€æ­¥åˆ›ä½œè§†é¢‘ã€‚\nç”¨æˆ·é€šè¿‡è¡¨å•æäº¤æç¤ºè¯å’Œå¯é€‰çš„å‚è€ƒå›¾ï¼Œç³»ç»Ÿè°ƒç”¨Nanoæ¨¡å‹ç”Ÿæˆå›¾ç‰‡ï¼Œç„¶åé€šè¿‡é‚®ä»¶å‘é€ç»™æŒ‡å®šäººå‘˜è¿›è¡Œç¡®è®¤ï¼Œæœ€åç”±å³æ¢¦æ¨¡å‹ç”Ÿæˆè§†é¢‘ã€‚\n\n\nâš™ï¸ **é…ç½®è¯´æ˜**\n1.  **Form Trigger (è¡¨å•è§¦å‘å™¨) é…ç½®**\n    * è¡¨å•æ ‡é¢˜: AIå›¾åƒåˆ›ä½œåŠ©æ‰‹ - Gemini Nano\n    * æç¤ºè¯å­—æ®µ: å¿…å¡«æ–‡æœ¬åŸŸï¼Œæ”¯æŒè¯¦ç»†æè¿°\n    * å‚è€ƒå›¾å­—æ®µ: å¯é€‰æ–‡ä»¶ä¸Šä¼ ï¼Œæ”¯æŒ.jpg/.png/.jpeg\n2.  **Code (ä»£ç ) èŠ‚ç‚¹å…³é”®é€»è¾‘**\n    * æ™ºèƒ½è¯†åˆ«ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶\n    * è‡ªåŠ¨ç»„è£…è°ƒç”¨Nanoæ¨¡å‹çš„å¤šæ¨¡æ€APIè¯·æ±‚ä½“\n    * å¤„ç†æ–‡æœ¬+å›¾ç‰‡çš„å¤åˆè¾“å…¥\n3.  **Human in the Loop (äººå·¥å®¡æ ¸) èŠ‚ç‚¹**\n    * é€šè¿‡Email SendèŠ‚ç‚¹å‘é€ç¡®è®¤é‚®ä»¶\n    * é‚®ä»¶å†…å®¹åŒ…å«ç”Ÿæˆçš„å›¾ç‰‡é¢„è§ˆå’Œâ€œæ˜¯å¦ç”Ÿæˆè§†é¢‘â€çš„é€‰é¡¹\n    * æ ¹æ®é‚®ä»¶å›å¤å†…å®¹ï¼Œå†³å®šæ˜¯å¦æ‰§è¡Œåç»­çš„è§†é¢‘ç”Ÿæˆæµç¨‹\n4.  **å³æ¢¦ (è§†é¢‘ç”Ÿæˆ) èŠ‚ç‚¹**\n    * è·å–ç¡®è®¤é‚®ä»¶ä¸­çš„è§†é¢‘æè¿°\n    * è°ƒç”¨å³æ¢¦æ¨¡å‹çš„APIï¼Œå°†é™æ€å›¾ç‰‡è½¬æ¢ä¸ºåŠ¨æ€è§†é¢‘\n\n\nğŸ’¡ ä½¿ç”¨åœºæ™¯\nâ€¢ çº¯æ–‡ç”Ÿå›¾: åªå¡«å†™æç¤ºè¯ï¼Œå¿«é€Ÿç”Ÿæˆåˆ›æ„å›¾ç‰‡\nâ€¢ AIä¿®å›¾: ä¸Šä¼ å‚è€ƒå›¾+æè¿°éœ€æ±‚ï¼Œæ™ºèƒ½å›¾ç‰‡ç¼–è¾‘\nâ€¢ é£æ ¼è½¬æ¢: å°†ç°æœ‰å›¾ç‰‡è½¬æ¢ä¸ºä¸åŒè‰ºæœ¯é£æ ¼\nâ€¢ è§’è‰²åˆ›ä½œ: æ ¹æ®æè¿°ç”Ÿæˆè§’è‰²å½¢è±¡æˆ–æ‰‹åŠæ•ˆæœ\nâ€¢ AIå›¾ç”Ÿè§†é¢‘: åœ¨å›¾ç‰‡ç”Ÿæˆåï¼Œé€šè¿‡é‚®ä»¶ç¡®è®¤å¹¶æä¾›è§†é¢‘æè¿°ï¼Œå°†é™æ€å›¾ç‰‡åŠ¨æ€åŒ–ï¼Œç”ŸæˆçŸ­è§†é¢‘ã€‚",
        "height": 848,
        "width": 2080,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2160,
        -432
      ],
      "typeVersion": 1,
      "id": "c93ffd9c-d66e-41a2-9740-d540b7268cc4",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a8f1c3f7-2f31-4a1b-819a-4257f7384713",
              "leftValue": "={{ $json.data['æ˜¯å¦ç”Ÿæˆè§†é¢‘ï¼Ÿ'] }}",
              "rightValue": "ç”Ÿæˆè§†é¢‘",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        352,
        -368
      ],
      "id": "30e4485f-7929-47bc-9883-0a6b9b265ec8",
      "name": "If1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        640,
        -192
      ],
      "id": "8af7969b-d4b1-4b1d-86fa-7b6fcde27361",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cdd33424-d48c-4bb0-85cf-f3d6b2d36257",
              "name": "prompt",
              "value": "={{ $('è§†é¢‘ç¡®è®¤').item.json.data['è§†é¢‘æè¿°'] }}",
              "type": "string"
            },
            {
              "id": "6af00053-b097-42d3-998d-ec5fc3bd8bc1",
              "name": "accessKeyId",
              "value": "={{ $env.VOLCENGINE_ACCESS_KEY_ID }}",
              "type": "string"
            },
            {
              "id": "cd6e2ed4-dd56-403b-8ea2-8d5f663ded74",
              "name": "secretAccessKey",
              "value": "={{ $env.VOLCENGINE_SECRET_ACCESS_KEY }}",
              "type": "string"
            },
            {
              "id": "ca99eada-db11-44da-a427-840b9d31effc",
              "name": "host",
              "value": "visual.volcengineapi.com",
              "type": "string"
            },
            {
              "id": "718c0a66-c78d-4947-bf05-9ef1f21cf267",
              "name": "serviceName",
              "value": "cv",
              "type": "string"
            },
            {
              "id": "2a0ad282-9f1f-4b9b-a78c-fb5b84ce7b7c",
              "name": "region",
              "value": "cn-north-1",
              "type": "string"
            },
            {
              "id": "2dcdd6c8-458b-4253-89e7-f59e64900aee",
              "name": "method",
              "value": "POST",
              "type": "string"
            },
            {
              "id": "6447ed97-9c06-4e4d-8d37-c53ef8655e5a",
              "name": "version",
              "value": "2022-08-31",
              "type": "string"
            },
            {
              "id": "46a1be81-7646-4748-bb0c-0ee59aadae8c",
              "name": "reqKey",
              "value": "jimeng_ti2v_v30_pro",
              "type": "string"
            },
            {
              "id": "c49498dc-33fa-4323-a2d3-68c8ceae4f02",
              "name": "binary_data_base64",
              "value": "=[\"{{ $('Extract Image Data').item.json.base }}\"]",
              "type": "array"
            },
            {
              "id": "fef3141a-60ef-4e1b-8cb4-d5f9d8ba1760",
              "name": "action",
              "value": "CVSync2AsyncSubmitTask",
              "type": "string"
            },
            {
              "id": "b645b22f-6280-4358-9394-2b299b0908be",
              "name": "retryCount",
              "value": "0",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        800,
        -384
      ],
      "id": "d3a62f1d-07b5-4b72-9006-103e296d4c9a",
      "name": "å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°"
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "# coding:utf-8\n\"\"\"\nåŸºäºä½ æä¾›çš„Pythonä»£ç æ”¹å†™çš„n8nç‰ˆæœ¬\n\"\"\"\n\nimport json\nimport datetime\nimport hashlib\nimport hmac\n\n# è·å–è¾“å…¥æ•°æ®\ninput_data = items[0]['json']\n\n# é…ç½®å‚æ•°\nmethod = 'POST'\nhost = 'visual.volcengineapi.com'\nregion = input_data.get('region', 'cn-north-1')  # ä½ è¯´çš„åŒºåŸŸ\naction = input_data.get('action', 'CVSync2AsyncSubmitTask')\nversion= input_data.get('version', '2022-08-31')\nreqKey= input_data.get('reqKey', 'jimeng_ti2v_v30_pro')\nendpoint = 'https://visual.volcengineapi.com'\nservice = 'cv'\n\n# ä»è¾“å…¥æ•°æ®è·å–å‡­è¯\naccess_key = input_data.get('accessKeyId', 'your-ak')\nsecret_key = input_data.get('secretAccessKey', 'your-sk')\nbinary_data_base64 = input_data.get('binary_data_base64', '')\nprint(f\"binary_data_base64 type: {type(binary_data_base64)}\")\nprint(f\"binary_data_base64 length: {len(str(binary_data_base64))}\")\n\ndef sign(key, msg):\n    return hmac.new(key, msg.encode('utf-8'), hashlib.sha256).digest()\n\ndef getSignatureKey(key, dateStamp, regionName, serviceName):\n    kDate = sign(key.encode('utf-8'), dateStamp)\n    kRegion = sign(kDate, regionName)\n    kService = sign(kRegion, serviceName)\n    kSigning = sign(kService, 'request')\n    return kSigning\n\ndef formatQuery(parameters):\n    request_parameters_init = ''\n    for key in sorted(parameters):\n        request_parameters_init += key + '=' + parameters[key] + '&'\n    request_parameters = request_parameters_init[:-1]\n    return request_parameters\n\ndef signV4Request(access_key, secret_key, service, req_query, req_body):\n    if access_key is None or secret_key is None:\n        return {'error': 'No access key is available.'}\n    \n    t = datetime.datetime.utcnow()\n    current_date = t.strftime('%Y%m%dT%H%M%SZ')\n    datestamp = t.strftime('%Y%m%d')  # Date w/o time, used in credential scope\n    \n    print(f\"=== åŸºæœ¬ä¿¡æ¯ ===\")\n    print(f\"Current Date: {current_date}\")\n    print(f\"Date Stamp: {datestamp}\")\n    print(f\"Region: {region}\")\n    print(f\"Service: {service}\")\n    print(f\"Method: {method}\")\n    print(f\"Host: {host}\")\n    print(f\"Access Key: {access_key[:10]}...\")  # åªæ˜¾ç¤ºå‰10ä½\n    print()\n    \n    canonical_uri = '/'\n    canonical_querystring = req_query\n    signed_headers = 'content-type;host;x-content-sha256;x-date'\n    payload_hash = hashlib.sha256(req_body.encode('utf-8')).hexdigest()\n    content_type = 'application/json'\n    \n    print(f\"=== è¯·æ±‚ä¿¡æ¯ ===\")\n    print(f\"Query String: {canonical_querystring}\")\n    print(f\"Body: {req_body}\")\n    print(f\"Body Bytes Length: {len(req_body.encode('utf-8'))}\")\n    print(f\"Payload Hash: {payload_hash}\")\n    print(f\"Content Type: {content_type}\")\n    print()\n    \n    canonical_headers = 'content-type:' + content_type + '\\n' + 'host:' + host + \\\n                       '\\n' + 'x-content-sha256:' + payload_hash + \\\n                       '\\n' + 'x-date:' + current_date + '\\n'\n    \n    print(f\"=== Canonical Headers ===\")\n    print(f\"Signed Headers: {signed_headers}\")\n    print(\"Canonical Headers:\")\n    print(repr(canonical_headers))\n    print()\n    \n    canonical_request = method + '\\n' + canonical_uri + '\\n' + canonical_querystring + \\\n                       '\\n' + canonical_headers + '\\n' + signed_headers + '\\n' + payload_hash\n    \n    print(\"=== Canonical Request ===\")\n    print(repr(canonical_request))  # ä½¿ç”¨ repr æ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦\n    print()\n    print(\"Canonical Request åŸæ–‡:\")\n    print(canonical_request)\n    print()\n    \n    canonical_request_hash = hashlib.sha256(canonical_request.encode('utf-8')).hexdigest()\n    print(f\"=== Canonical Request Hash ===\")\n    print(canonical_request_hash)\n    print()\n    \n    algorithm = 'HMAC-SHA256'\n    credential_scope = datestamp + '/' + region + '/' + service + '/' + 'request'\n    string_to_sign = algorithm + '\\n' + current_date + '\\n' + credential_scope + '\\n' + canonical_request_hash\n    \n    print(\"=== String to Sign ===\")\n    print(f\"Algorithm: {algorithm}\")\n    print(f\"Current Date: {current_date}\")\n    print(f\"Credential Scope: {credential_scope}\")\n    print(f\"Canonical Request Hash: {canonical_request_hash}\")\n    print()\n    print(\"String to Sign åŸæ–‡:\")\n    print(repr(string_to_sign))\n    print()\n    print(string_to_sign)\n    print()\n    \n    # é€æ­¥æ˜¾ç¤ºç­¾åkeyç”Ÿæˆè¿‡ç¨‹\n    print(\"=== ç­¾åKeyç”Ÿæˆè¿‡ç¨‹ ===\")\n    kDate = sign(secret_key.encode('utf-8'), datestamp)\n    print(f\"kDate (hex): {kDate.hex()}\")\n    \n    kRegion = sign(kDate, region)\n    print(f\"kRegion (hex): {kRegion.hex()}\")\n    \n    kService = sign(kRegion, service)\n    print(f\"kService (hex): {kService.hex()}\")\n    \n    kSigning = sign(kService, 'request')\n    print(f\"kSigning (hex): {kSigning.hex()}\")\n    print()\n    \n    signature = hmac.new(kSigning, (string_to_sign).encode('utf-8'), hashlib.sha256).hexdigest()\n    \n    print(f\"=== Final Signature ===\")\n    print(f\"Signature Length: {len(signature)}\")\n    print(f\"Signature: {signature}\")\n    print()\n    \n    authorization_header = algorithm + ' ' + 'Credential=' + access_key + '/' + \\\n                          credential_scope + ', ' + 'SignedHeaders=' + \\\n                          signed_headers + ', ' + 'Signature=' + signature\n    \n    print(f\"=== Authorization Header ===\")\n    print(authorization_header)\n    print()\n    \n    headers = {\n        'X-Date': current_date,\n        'Authorization': authorization_header,\n        'X-Content-Sha256': payload_hash,\n        'Content-Type': content_type\n    }\n    \n    request_url = endpoint + '?' + canonical_querystring\n    \n    return {\n        'headers': headers,\n        'url': request_url,\n        'body': req_body,\n        'debug': {\n            'canonical_request': canonical_request,\n            'string_to_sign': string_to_sign,\n            'signature': signature,\n            'authorization': authorization_header,\n            'payload_hash': payload_hash,\n            'current_date': current_date,\n            'credential_scope': credential_scope,\n            'region': region,\n            'service': service,\n            'canonical_request_hash': canonical_request_hash\n        }\n    }\n\n# è¯·æ±‚Queryï¼Œæ ¹æ®ä½ çš„éœ€æ±‚è°ƒæ•´\nquery_params = {\n    'Action': action,  # ä½ ä¹‹å‰ç”¨çš„Action\n    'Version': version,  # ä½ ä¹‹å‰ç”¨çš„Version\n}\nformatted_query = formatQuery(query_params)\nif binary_data_base64:\n    binary_data_base64 = str(binary_data_base64)\n  \n# è¯·æ±‚Bodyï¼Œä½¿ç”¨ä½ æä¾›çš„æ­£ç¡®å‚æ•°\nbody_params = {\n    \"binary_data_base64\": [binary_data_base64],\n    \"seed\": -1,\n    \"prompt\": input_data.get('prompt', 'your-ak'),\n    \"req_key\": reqKey\n}\n# ç¡®ä¿JSONåºåˆ—åŒ–ä¸åŒ…å«é¢å¤–ç©ºæ ¼ï¼Œä¸åŸå§‹ä»£ç ä¿æŒä¸€è‡´\nformatted_body = json.dumps(body_params, separators=(',', ':'), ensure_ascii=False)\n\n# æ‰§è¡Œç­¾å\nresult = signV4Request(access_key, secret_key, service, formatted_query, formatted_body)\n\n# è¿”å›ç»“æœç»™ n8n\nreturn [{\"json\": result}]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1136,
        -384
      ],
      "id": "7f7245bc-12c3-4949-8e75-8102fbd8d585",
      "name": "Code: æ ¼å¼åŒ–è¯·æ±‚ä½“"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://visual.volcengineapi.com",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "Action",
              "value": "={{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.action }}"
            },
            {
              "name": "Version",
              "value": "={{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.version }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $json.headers.Authorization }}"
            },
            {
              "name": "Host",
              "value": "visual.volcengineapi.com"
            },
            {
              "name": "X-Content-Sha256",
              "value": "={{ $json.headers['X-Content-Sha256'] }}"
            },
            {
              "name": "X-Date",
              "value": "={{ $json.headers['X-Date'] }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\"binary_data_base64\": [\"{{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.binary_data_base64[0] }}\"],\"seed\": -1,\"prompt\":\"{{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.prompt }}\",\"req_key\":\"{{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.reqKey }}\"}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1376,
        -384
      ],
      "id": "ee260f0e-cc06-4401-906f-8c71a076617a",
      "name": "æäº¤ç”Ÿè§†é¢‘ä»»åŠ¡",
      "retryOnFail": true
    },
    {
      "parameters": {
        "language": "python",
        "pythonCode": "# coding:utf-8\n\"\"\"\nåŸºäºä½ æä¾›çš„Pythonä»£ç æ”¹å†™çš„n8nç‰ˆæœ¬\n\"\"\"\n\nimport json\nimport datetime\nimport hashlib\nimport hmac\n\ntry:\n  # è·å–è¾“å…¥æ•°æ®\n  input_data = _(\"å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°\").first().json\n  # é…ç½®å‚æ•°\n  method = 'POST'\n  host = 'visual.volcengineapi.com'\n  region = input_data.get('region', 'cn-beijing')  # ä½ è¯´çš„åŒºåŸŸ\n  action = input_data.get('action', 'CVSync2AsyncSubmitTask')\n  version= input_data.get('version', '2022-08-31')\n  reqKey= input_data.get('reqKey', 'jimeng_ti2v_v30_pro')\n  endpoint = 'https://visual.volcengineapi.com'\n  service = 'cv'\n  \n  # ä»è¾“å…¥æ•°æ®è·å–å‡­è¯\n  access_key = input_data.get('accessKeyId', 'your-ak')\n  secret_key = input_data.get('secretAccessKey', 'your-sk')\n  \n  def sign(key, msg):\n      return hmac.new(key, msg.encode('utf-8'), hashlib.sha256).digest()\n  \n  def getSignatureKey(key, dateStamp, regionName, serviceName):\n      kDate = sign(key.encode('utf-8'), dateStamp)\n      kRegion = sign(kDate, regionName)\n      kService = sign(kRegion, serviceName)\n      kSigning = sign(kService, 'request')\n      return kSigning\n  \n  def formatQuery(parameters):\n      request_parameters_init = ''\n      for key in sorted(parameters):\n          request_parameters_init += key + '=' + parameters[key] + '&'\n      request_parameters = request_parameters_init[:-1]\n      return request_parameters\n  \n  def signV4Request(access_key, secret_key, service, req_query, req_body):\n      if access_key is None or secret_key is None:\n          return {'error': 'No access key is available.'}\n      \n      t = datetime.datetime.utcnow()\n      current_date = t.strftime('%Y%m%dT%H%M%SZ')\n      datestamp = t.strftime('%Y%m%d')  # Date w/o time, used in credential scope\n      \n      print(f\"=== åŸºæœ¬ä¿¡æ¯ ===\")\n      print(f\"Current Date: {current_date}\")\n      print(f\"Date Stamp: {datestamp}\")\n      print(f\"Region: {region}\")\n      print(f\"Service: {service}\")\n      print(f\"Method: {method}\")\n      print(f\"Host: {host}\")\n      print(f\"Access Key: {access_key[:10]}...\")  # åªæ˜¾ç¤ºå‰10ä½\n      print()\n      \n      canonical_uri = '/'\n      canonical_querystring = req_query\n      signed_headers = 'content-type;host;x-content-sha256;x-date'\n      payload_hash = hashlib.sha256(req_body.encode('utf-8')).hexdigest()\n      content_type = 'application/json'\n      \n      print(f\"=== è¯·æ±‚ä¿¡æ¯ ===\")\n      print(f\"Query String: {canonical_querystring}\")\n      print(f\"Body: {req_body}\")\n      print(f\"Body Bytes Length: {len(req_body.encode('utf-8'))}\")\n      print(f\"Payload Hash: {payload_hash}\")\n      print(f\"Content Type: {content_type}\")\n      print()\n      \n      canonical_headers = 'content-type:' + content_type + '\\n' + 'host:' + host + \\\n                         '\\n' + 'x-content-sha256:' + payload_hash + \\\n                         '\\n' + 'x-date:' + current_date + '\\n'\n      \n      print(f\"=== Canonical Headers ===\")\n      print(f\"Signed Headers: {signed_headers}\")\n      print(\"Canonical Headers:\")\n      print(repr(canonical_headers))\n      print()\n      \n      canonical_request = method + '\\n' + canonical_uri + '\\n' + canonical_querystring + \\\n                         '\\n' + canonical_headers + '\\n' + signed_headers + '\\n' + payload_hash\n      \n      print(\"=== Canonical Request ===\")\n      print(repr(canonical_request))  # ä½¿ç”¨ repr æ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦\n      print()\n      print(\"Canonical Request åŸæ–‡:\")\n      print(canonical_request)\n      print()\n      \n      canonical_request_hash = hashlib.sha256(canonical_request.encode('utf-8')).hexdigest()\n      print(f\"=== Canonical Request Hash ===\")\n      print(canonical_request_hash)\n      print()\n      \n      algorithm = 'HMAC-SHA256'\n      credential_scope = datestamp + '/' + region + '/' + service + '/' + 'request'\n      string_to_sign = algorithm + '\\n' + current_date + '\\n' + credential_scope + '\\n' + canonical_request_hash\n      \n      print(\"=== String to Sign ===\")\n      print(f\"Algorithm: {algorithm}\")\n      print(f\"Current Date: {current_date}\")\n      print(f\"Credential Scope: {credential_scope}\")\n      print(f\"Canonical Request Hash: {canonical_request_hash}\")\n      print()\n      print(\"String to Sign åŸæ–‡:\")\n      print(repr(string_to_sign))\n      print()\n      print(string_to_sign)\n      print()\n      \n      # é€æ­¥æ˜¾ç¤ºç­¾åkeyç”Ÿæˆè¿‡ç¨‹\n      print(\"=== ç­¾åKeyç”Ÿæˆè¿‡ç¨‹ ===\")\n      kDate = sign(secret_key.encode('utf-8'), datestamp)\n      print(f\"kDate (hex): {kDate.hex()}\")\n      \n      kRegion = sign(kDate, region)\n      print(f\"kRegion (hex): {kRegion.hex()}\")\n      \n      kService = sign(kRegion, service)\n      print(f\"kService (hex): {kService.hex()}\")\n      \n      kSigning = sign(kService, 'request')\n      print(f\"kSigning (hex): {kSigning.hex()}\")\n      print()\n      \n      signature = hmac.new(kSigning, (string_to_sign).encode('utf-8'), hashlib.sha256).hexdigest()\n      \n      print(f\"=== Final Signature ===\")\n      print(f\"Signature Length: {len(signature)}\")\n      print(f\"Signature: {signature}\")\n      print()\n      \n      authorization_header = algorithm + ' ' + 'Credential=' + access_key + '/' + \\\n                            credential_scope + ', ' + 'SignedHeaders=' + \\\n                            signed_headers + ', ' + 'Signature=' + signature\n      \n      print(f\"=== Authorization Header ===\")\n      print(authorization_header)\n      print()\n      \n      headers = {\n          'X-Date': current_date,\n          'Authorization': authorization_header,\n          'X-Content-Sha256': payload_hash,\n          'Content-Type': content_type\n      }\n      \n      request_url = endpoint + '?' + canonical_querystring\n      \n      return {\n          'headers': headers,\n          'url': request_url,\n          'body': req_body,\n          'debug': {\n              'canonical_request': canonical_request,\n              'string_to_sign': string_to_sign,\n              'signature': signature,\n              'authorization': authorization_header,\n              'payload_hash': payload_hash,\n              'current_date': current_date,\n              'credential_scope': credential_scope,\n              'region': region,\n              'service': service,\n              'canonical_request_hash': canonical_request_hash\n          }\n      }\n  \n  # è¯·æ±‚Queryï¼Œæ ¹æ®ä½ çš„éœ€æ±‚è°ƒæ•´\n  query_params = {\n      'Action': 'CVSync2AsyncGetResult',  # ä½ ä¹‹å‰ç”¨çš„Action\n      'Version': version,  # ä½ ä¹‹å‰ç”¨çš„Version\n  }\n  formatted_query = formatQuery(query_params)\n  \n  task_id = _(\"æäº¤ç”Ÿè§†é¢‘ä»»åŠ¡\").first().json.data.task_id\n  # è¯·æ±‚Bodyï¼Œä½¿ç”¨ä½ æä¾›çš„æ­£ç¡®å‚æ•°\n  body_params = {\n      \"req_key\": reqKey,\n      \"task_id\": task_id\n  }\n  # ç¡®ä¿JSONåºåˆ—åŒ–ä¸åŒ…å«é¢å¤–ç©ºæ ¼ï¼Œä¸åŸå§‹ä»£ç ä¿æŒä¸€è‡´\n  formatted_body = json.dumps(body_params, separators=(',', ':'), ensure_ascii=False)\n  \n  # æ‰§è¡Œç­¾å\n  result = signV4Request(access_key, secret_key, service, formatted_query, formatted_body)\n  \n  # è¿”å›ç»“æœç»™ n8n\n  return [{\"json\": result}]\nexcept Exception as e:\n    # Stop and Error\n    raise Exception(f\"æ•°æ®è·å–å¤±è´¥: {str(e)}\")"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        304,
        -32
      ],
      "id": "e07dd7c8-f575-4ad4-817d-24bb500c33d7",
      "name": "æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°",
      "alwaysOutputData": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "errorMessage": "={{ $json.error }}"
      },
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        544,
        112
      ],
      "id": "5ed8ac1e-db1a-4370-b592-a9b0cb4c786a",
      "name": "Stop and Error"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://visual.volcengineapi.com",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "Action",
              "value": "=CVSync2AsyncGetResult"
            },
            {
              "name": "=Version",
              "value": "={{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.version }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°').item.json.headers.Authorization }}"
            },
            {
              "name": "Host",
              "value": "visual.volcengineapi.com"
            },
            {
              "name": "X-Content-Sha256",
              "value": "={{ $('æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°').item.json.headers['X-Content-Sha256'] }}"
            },
            {
              "name": "X-Date",
              "value": "={{ $('æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°').item.json.headers['X-Date'] }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"req_key\":\"{{ $('å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°').item.json.reqKey }}\",\n  \"task_id\": \"{{ $('æäº¤ç”Ÿè§†é¢‘ä»»åŠ¡').item.json.data.task_id }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        752,
        -48
      ],
      "id": "c1edbae5-b9b2-4f07-81b5-cbc84b9b641f",
      "name": "æŸ¥è¯¢ä»»åŠ¡",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "error-check-1",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "error-check-2",
              "leftValue": "={{ $json.error.message }}",
              "rightValue": "Risk Not",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        960,
        -48
      ],
      "id": "f7b2f3ae-1b77-47e9-bf1d-1758280ad789",
      "name": "é”™è¯¯æ£€æŸ¥"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "error-record-1",
              "name": "error_type",
              "value": "={{ $json.error.name || 'Unknown Error' }}",
              "type": "string"
            },
            {
              "id": "error-record-4",
              "name": "error_details",
              "value": "={{ {\n  \"error_message\": $json.errorMessage,\n  \"error_description\": $json.errorDescription,\n  \"http_code\": $json.errorDetails?.httpCode,\n  \"raw_error\": $json.errorDetails?.rawErrorMessage?.[0],\n  \"error_time\": $now.toISO(),\n  \"node_name\": $json.n8nDetails?.nodeName\n} }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1280,
        -64
      ],
      "id": "862f96d4-da18-4661-8faa-78ac65e03487",
      "name": "è®°å½•é”™è¯¯è¯¦æƒ…"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ec0664c8-8142-45ac-9fbf-c0fa33cff3dc",
              "leftValue": "={{ $json.data.status }}",
              "rightValue": "done",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1136,
        112
      ],
      "id": "eb012286-e56c-41fd-809c-ad509ea4ba0e",
      "name": "çŠ¶æ€æ£€æŸ¥"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        528,
        -48
      ],
      "id": "67ae2163-3e14-41dc-8e12-4ee7bb4c62c1",
      "name": "Wait1",
      "webhookId": "6734babe-3510-4c02-93c3-32c0d7d8b914"
    },
    {
      "parameters": {
        "content": "#### é…ç½®ç«å±±å¼•æ“ä¿¡æ¯ ğŸ‘‡",
        "height": 80,
        "width": 214,
        "color": 3
      },
      "id": "a14bdffe-41dc-4f65-bf32-de76a7d36063",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        736,
        -416
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## ç”Ÿæˆè§†é¢‘",
        "height": 720,
        "width": 1824,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -16,
        -432
      ],
      "typeVersion": 1,
      "id": "c786c971-6b8c-42cb-a716-cbbd90bbd43c",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "fromEmail": "linq319@163.com",
        "toEmail": "lqshow@gmail.com",
        "subject": "è§†é¢‘ç¡®è®¤",
        "message": "å›¾ç‰‡ç”Ÿæˆå®Œæˆ - æ˜¯å¦ç”Ÿæˆè§†é¢‘ï¼Ÿ",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "æ˜¯å¦ç”Ÿæˆè§†é¢‘ï¼Ÿ",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "ç”Ÿæˆè§†é¢‘"
                  },
                  {
                    "option": "è·³è¿‡è§†é¢‘ç”Ÿæˆ"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "è§†é¢‘æè¿°",
              "fieldType": "textarea",
              "placeholder": "=æè¿°æ‚¨å¸Œæœ›è§†é¢‘ä¸­å‘ç”Ÿçš„åŠ¨ä½œæˆ–å˜åŒ–ï¼Œä¾‹å¦‚ï¼š\n- çŒ«å’ªæ…¢æ…¢è½¬å¤´çœ‹å‘é•œå¤´\n- æ ‘å¶åœ¨å¾®é£ä¸­è½»è½»æ‘†åŠ¨\n- äººç‰©çœ¨çœ¼å¹¶å¾®ç¬‘\n- æ°´é¢æ³¢çº¹è½»æŸ”è¡æ¼¾",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        80,
        -368
      ],
      "id": "5f9e70ef-6697-4367-807c-c0ed7c62994a",
      "name": "è§†é¢‘ç¡®è®¤",
      "webhookId": "97ff1934-d7cf-4936-9874-e67644f9e3a1",
      "credentials": {
        "smtp": {
          "id": "leCZ8pa94fswDhiS",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.data.video_url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1408,
        160
      ],
      "id": "80c76777-d7ef-4451-aa8a-3975ebce755f",
      "name": "HTTP Request1"
    }
  ],
  "pinData": {},
  "connections": {
    "On form submission": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Merge Response Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Network Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Response Data": {
      "main": [
        [
          {
            "node": "Content Filter Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Content Filter Check": {
      "main": [
        [
          {
            "node": "Prohibited Content End",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Image Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Check": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract Image Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Image Data": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "è§†é¢‘ç¡®è®¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‡†å¤‡è§†é¢‘ç”Ÿæˆå‚æ•°": {
      "main": [
        [
          {
            "node": "Code: æ ¼å¼åŒ–è¯·æ±‚ä½“",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: æ ¼å¼åŒ–è¯·æ±‚ä½“": {
      "main": [
        [
          {
            "node": "æäº¤ç”Ÿè§†é¢‘ä»»åŠ¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æäº¤ç”Ÿè§†é¢‘ä»»åŠ¡": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Stop and Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è¯¢ä»»åŠ¡": {
      "main": [
        [
          {
            "node": "é”™è¯¯æ£€æŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é”™è¯¯æ£€æŸ¥": {
      "main": [
        [
          {
            "node": "è®°å½•é”™è¯¯è¯¦æƒ…",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "çŠ¶æ€æ£€æŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®°å½•é”™è¯¯è¯¦æƒ…": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çŠ¶æ€æ£€æŸ¥": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ ¼å¼åŒ–æŸ¥è¯¢ä»»åŠ¡å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢ä»»åŠ¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘ç¡®è®¤": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Success Form",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "29ce1b16-bbc6-4a44-a1a7-0fd1c64b4c02",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a152539bc323133bde80781a1dc51fefe2ad2e9f6579ca96b98f3bb66ae5bb00"
  },
  "id": "iMWHJXXdCIwLPLGO",
  "tags": [
    {
      "createdAt": "2025-07-24T01:13:19.506Z",
      "updatedAt": "2025-07-24T01:13:33.568Z",
      "id": "MYnVFZwT2gKoYf9C",
      "name": "auto-flow-academy"
    }
  ]
}